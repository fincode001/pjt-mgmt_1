---

## 3. 기능 요구사항 (업데이트)

### 3.1. 핵심 기능

#### 3.1.1. 프로젝트 관리 (Project Management)

**F-001: 신규 프로젝트 등록**
- 프로젝트 제목, 코드 자동 생성, 개요 입력
- 중요도(1-5점)/긴급도(1-5점) 설정
- 일정 설정 (시작일, 종료일, 접수일)
- 상태 관리 (미착수, 진행중, 보류중단, 종료)
- 진척률 설정 (0-100%)
- 담당자 정보 (제공자, 전달자) 등록
- **노션 연동 정보 설정** (노션 워크스페이스 ID, 페이지 ID, API 토큰)
- 우선순위: **높음**

**F-002: 프로젝트 목록 조회 및 관리**
- 프로젝트 목록 테이블 형태로 표시
- 상태별, 중요도별, 긴급도별 필터링
- 프로젝트명 검색 기능
- 페이지네이션 지원
- 정렬 기능 (제목, 일정, 진척률 등)
- 우선순위: **높음**

**F-003: 프로젝트 상세 정보 조회**
- 프로젝트 전체 정보 조회
- 관련 프로젝트 표시
- 담당자 정보 표시
- 첨부 파일 목록 표시
- 프로젝트 편집 기능 제공
- 우선순위: **높음**

**F-004: 프로젝트 우선순위 관리**
- 중요도/긴급도 매트릭스 기반 우선순위 설정
- 드래그앤드롭을 통한 우선순위 변경
- 우선순위 변경 이력 추적
- 자동 저장 기능
- 우선순위: **중간**

#### 3.1.2. 대시보드 및 분석 (Dashboard & Analytics)

**F-005: 프로젝트 현황 대시보드**
- 전체 프로젝트 통계 (총 프로젝트 수, 진행중, 완료, 보류)
- 평균 진척률 표시
- 프로젝트 상태별 분포 차트 (파이 차트)
- 중요도/긴급도 분포 차트 (막대 차트)
- 일정 경과율 대비 진척률 비교 차트 (라인 차트)
- 간트 차트 형태의 프로젝트 일정 관리
- 우선순위: **높음**

**F-006: 프로젝트 관계도 시각화**
- 프로젝트 간 관계성을 그래프로 표시
- 관계도 수준 (상/중/하) 시각적 구분
- 관계성 설명 표시
- 인터랙티브 노드 및 링크
- 우선순위: **중간**

#### 3.1.3. 요구사항 관리 (Requirements Management)

**F-007: 사용자 요구사항 등록 및 관리**
- 요구사항 등록, 수정, 삭제
- 중요도, 긴급도 설정
- 상태 관리 (등록, 검토중, 승인, 거부, 완료)
- 담당자 배정
- 요구사항 분류 (기능, 비기능, 제약사항)
- **요구사항 등록 유형 선택** (신규, 수정, 삭제, 추가등록, 개선제안)
- **계층적 요구사항 구조 지원** (부모-자식 관계)
- **변경 이력 추적 및 사유 기록**
- **삭제된 요구사항 복원 기능**
- 우선순위: **높음**

**F-008: 요구사항 목록 조회**
- 상태별 필터링
- 중요도/긴급도별 정렬
- 검색 기능
- 페이지네이션
- **요구사항 유형별 필터링** (신규, 수정, 삭제, 추가등록, 개선제안)
- **삭제된 요구사항 보기 옵션**
- 우선순위: **중간**

**F-013: AI 질의응답 시스템**
- 사용자와 AI 간의 양방향 소통
- 요구사항에 대한 질문과 답변
- 질의응답 스레드 구조 (원글 → 답글 → 추가 답글)
- **권한 구분**: 사용자(CRUD), AI(CR)
- 질문 유형: 사용자→AI, AI→사용자, 사용자→사용자
- **모든 요구사항 유형에 질의응답 지원**: 신규/수정/삭제/추가등록/개선제안 각 유형별 맞춤형 질의응답
- **질의응답 분류 체계**: 유형별, 상태별(해결/미해결), 중요도별 분류
- 마크다운 지원 리치 텍스트 에디터
- 실시간 알림 기능
- 우선순위: **높음**

**F-015: 프로젝트 최종정리 생성**
- 프로젝트의 모든 변경사항을 종합적으로 정리
- "최종정리" 버튼으로 현재 시점까지의 모든 데이터 정리
- 정리 문서 구성: 프로젝트명, 정리 내용, 생성 일시
- **노션 사이트 자동 연동**: 지정된 노션 페이지에 정리 내용 전달
- 정리 대상: 유지/삭제/변경/추가된 요구사항, 질의응답, 관련 자료
- 정리 문서 다운로드 (PDF, 마크다운)
- 정리 이력 관리
- 우선순위: **높음**

#### 3.1.4. 리소스 관리 (Resource Management)

**F-009: 작업 폴더 관리**
- 프로젝트별 폴더 구조 관리
- 파일 업로드/다운로드 기능
- 드래그앤드롭 파일 업로드
- 폴더 생성, 삭제, 이름 변경
- 파일 검색 기능
- 용량 관리 및 통계
- 우선순위: **중간**

**F-010: 환경 정보 관리**
- 프로젝트별 환경 변수 관리
- 카테고리별 분류 (DB, API, 클라우드, 서버)
- .env.sample 파일 자동 생성
- 환경 변수 검색 및 필터링
- 우선순위: **중간**

**F-011: 참고 URL 관리**
- URL 등록, 수정, 삭제
- 카테고리별 분류 (웹사이트, 유튜브, GitHub, 문서, API)
- URL 미리보기 기능
- 유튜브 썸네일 표시
- 태그 기반 분류
- 우선순위: **낮음**

**F-012: MCP 서버 리스트 관리**
- 서버 등록, 수정, 삭제
- 서버 상태 모니터링 (온라인, 오프라인, 경고)
- CPU, 메모리, 디스크 사용량 표시
- 서버 로그 조회
- 서버 유형별 분류 (애플리케이션, DB, 웹, 캐시)
- 우선순위: **낮음**

#### 3.1.5. 사용자 관리 및 설정 (User Management & Settings)

**F-014: 사용자 설정**
- 일반 설정 (언어, 시간대, 자동 저장)
- 테마 설정 (다크 모드, 강조 색상, 글꼴 크기)
- 알림 설정 (이메일, 브라우저, 프로젝트 마감일)
- 보안 설정 (비밀번호 변경, 2단계 인증)
- 프로필 관리
- 우선순위: **낮음**

### 3.2. 상세 기능 명세

#### 3.2.1. 프로젝트 코드 자동 생성 규칙
- 형식: YYYY-[분류]-[대분류]-[중분류]-Ver[버전]
- 예시: 2025-A-01-001-Ver0.1
- 연도: 4자리 년도
- 분류: A, B, C, D (사용자 정의 가능)
- 대분류: 01-99 (2자리 숫자)
- 중분류: 001-999 (3자리 숫자)
- 버전: x.y 형태

#### 3.2.2. 프로젝트 관계성 정의
- **상(High)**: 직접적인 의존 관계, 한 프로젝트의 결과가 다른 프로젝트의 필수 입력
- **중(Medium)**: 간접적인 연관 관계, 데이터나 결과를 부분적으로 공유
- **하(Low)**: 참조 관계, 유사한 기술이나 도구를 사용하거나 동일한 팀이 참여

#### 3.2.3. 일정 경과율 계산
```
일정 경과율 = (현재 날짜 - 시작일) / (종료일 - 시작일) × 100
단, 현재 날짜가 시작일 이전이면 0%, 종료일 이후면 100%
```

#### 3.2.4. 우선순위 계산 공식
```
우선순위 점수 = (중요도 × 0.7) + (긴급도 × 0.3)
우선순위 등급:
- 4.0 이상: 최우선
- 3.0 이상: 높음
- 2.0 이상: 보통
- 2.0 미만: 낮음
```

#### 3.2.5. 요구사항 등록 유형 처리 로직
```
신규 등록:
  - 새 요구사항 레코드 생성
  - requirement_action = 'new'
  - parent_requirement_id = NULL

수정:
  - 기존 요구사항 업데이트
  - 변경 이전 값 requirement_audit_log 테이블에 저장
  - requirement_action = 'update'

삭제:
  - is_deleted = true 설정 (논리적 삭제)
  - delete_reason 필드에 삭제 사유 저장
  - requirement_action = 'delete'

추가 등록:
  - 새 요구사항 레코드 생성
  - requirement_action = 'additional'
  - parent_requirement_id = 연관된 요구사항 ID

개선 제안:
  - 새 요구사항 레코드 생성
  - requirement_action = 'improvement'
  - parent_requirement_id = 개선 대상 요구사항 ID
  - 기본 상태 = '검토중'
```

#### 3.2.6. 질의응답 스레드 구조
```
원본 요구사항 (requirements 테이블) - 모든 요구사항 유형 지원
  |
  +-- QnA 스레드 (qna_threads 테이블) - 요구사항 유형별 관련 스레드 관리
       |
       +-- 메시지 1: 질문 (qna_messages 테이블) - 사용자/AI 질문
            |
            +-- 메시지 2: 답변 (parent_message_id = 메시지 1 ID) - 사용자/AI 답변
                 |
                 +-- 메시지 3: 추가 질문 (parent_message_id = 메시지 2 ID)
                      |
                      +-- 메시지 4: 추가 답변 (parent_message_id = 메시지 3 ID)
```

#### 3.2.6.1 요구사항 유형별 질의응답 연결
```
// 신규등록 요구사항의 질의응답 처리
신규 요구사항
  |
  +-- 요구사항 명확화 질의응답
  |    |
  |    +-- AI: "이 요구사항의 우선순위가 어떻게 되나요?"
  |         |
  |         +-- 사용자: "높음 우선순위입니다."
  |
  +-- 요구사항 상세화 질의응답
       |
       +-- 사용자: "이 기능의 구체적인 입력값은 무엇인가요?"
            |
            +-- AI: "입력값은 다음과 같습니다: [상세 내용]"

// 수정된 요구사항의 질의응답 처리
수정된 요구사항
  |
  +-- 수정 사유 관련 질의응답
  |    |
  |    +-- AI: "이 변경이 다른 모듈에 영향을 주나요?"
  |         |
  |         +-- 사용자: "아니오, 이 모듈에만 영향을 줍니다."
  |
  +-- 수정 내용 관련 질의응답
       |
       +-- 사용자: "변경된 부분의 테스트 케이스가 필요한가요?"
            |
            +-- AI: "네, 다음과 같은 테스트 케이스가 필요합니다: [상세 내용]"

// 이하 삭제, 추가등록, 개선제안 요구사항도 유사한 구조로 질의응답 지원
```

#### 3.2.7. 프로젝트 최종정리 생성 프로세스
```
1. 최종정리 버튼 클릭
2. 프로젝트 데이터 수집:
   - 기본 정보 조회
   - 요구사항 전체 이력 조회
   - 질의응답 스레드 조회
   - 관련 자료 조회
3. 정리 문서 생성:
   - 마크다운 형식 문서 생성
   - 변경사항 카테고리별 구성
   - 타임스탬프 추가
4. 노션 연동:
   - 노션 API 연동 정보 확인
   - API 호출하여 페이지 생성/업데이트
5. 결과 저장:
   - project_summaries 테이블에 기록
   - 스냅샷 저장 (data_snapshot 필드)
   - 노션 URL 저장
```

#### 3.2.8. 노션 API 연동 구조
```
{
  "parent": {
    "page_id": "{노션 페이지 ID}"
  },
  "properties": {
    "title": [
      {
        "text": {
          "content": "{프로젝트명} - 최종정리 ({날짜})"
        }
      }
    ]
  },
  "children": [
    {
      "object": "block",
      "type": "heading_1",
      "heading_1": {
        "rich_text": [
          {
            "type": "text",
            "text": {
              "content": "프로젝트 요약"
            }
          }
        ]
      }
    },
    // 추가 컨텐츠 블록...
  ]
}
```